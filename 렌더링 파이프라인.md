# 렌더링 파이프라인

3차원의 세계를 2차원으로 나타내는 일련의 과정을 의미한다.

- 원근법을 적용해 소실점을 만들다. 즉, 가까이 있는 물체는 크게, 멀리 있는 물체는 작게 보이게 만든다.
- 물체가 그 뒤에 있는 물체를 가리는 물체 겹침을 만들어 뒤에 있는 물체의 일부 혹은 전체를 가리게 만든다.
- 3차원 물체의 부피감을 묘사하기 위해 조명과 음영을 적용한다.
- 그림자는 광원의 위치에 대한 단서를 보여주고, 해당 물체가 지표면에서 얼마나 떠 있는지를 제시한다.

### 모형의 표현

Direct3D 응용프로그램에서는 삼각형으로 구성된 메시로 근사해서 표현한다.

### 컴퓨터 색상의 기본 개념

컴퓨터 모니터는 픽셀마다 빨간색, 녹색, 파란색 빛을 섞어서 방출한다. 

### 색상의 연산

색상끼리 더하거나 뺄 수 있다. (1,1,1)에 (0.5, 0.5, 0.5)를 빼면 회색이 될 것이다. 같은 방법으로 곱샘도 가능하다. 성분별 곱셈은 조명연산에 사용된다.

## 본격적으로 렌더링 파이프라인

렌더링파이프라인은

- 입력 조립기 단계(IA)
- 정점셰이더 단계(Vertex Shader)
- 덮개 셰이더 단계(HS)
- 테셀레이터 단계 (GPU 자원 X)
- 영역 셰이더 단계(DS)
- 기하 셰이더 단계(GS)
- 스트림 출력 단계(SO)  (GPU 자원 O)
- 픽셀 셰이더 단계(PS)
- 출력  병합기 단계(OS)

### 입력 조립기 단계(Input Assembler)

입력 조립기 단계에서는 메모리에서 기하자료(정점과 색인들)을 읽어서 기하학적 기본도형(Primitive: 삼각형, 선분, 점 등)을 조립한다. Quad라면, 4개의 정점으로(중복 정점들을 없애고) 선 띠, 삼각형 띠 등으로 조립한다...

### 정점셰이더 단계(Vertex Shader)

#### 로컬 스페이스, 월드 스페이스

입력 조립기 단계에서 기본 도형들을 조립한 후 해당 정점들을 정점 셰이더로 넘겨준다. ***
로컬 공간에서 작업한 3D 오브젝트를 글로벌 좌표(월드 좌표, 월드 공간)으로 가져 와야 한다. 이를 월드 변환이라고 한다(World Transform). 월드 변환에 해당하는 행렬을 월드 행렬(World Matrix)라고 부른다.
이렇게 로컬 공간을 사용하는 오브젝트를 월드 공간으로 변환하는 방법을 사용하면, 여러번 재사용할 수도 있고 더 쉽게 표현할 수 있다.(인스턴싱)

#### 시야 공간 (View Space, Camera space)

3차원 장면에서 2차원 이미지를 만들어 내려면 가상 카메라를 배치 해야 한다.

#### 투영과 동차 절단 공간(뷰 프러스텀)

카메라에 보이는 공간을 정의

### 테셀레이션 단계

삼각형을 더 세분화. 가까이 있는 삼각형은 잘게 만들고 멀리 있는 삼각형은 그대로 냅둬  LOD를 구현할 수 있다.

### 기하 셰이더 단계

### 절단

시야 절두체 바깥에 있는 기하구조를 폐기하는 단계 ++

### 레스터화 단계

3차원 삼각형으로부터 픽셀 색상들을 계산

### 픽셀셰이더 단계

### 출력 병합기 단계